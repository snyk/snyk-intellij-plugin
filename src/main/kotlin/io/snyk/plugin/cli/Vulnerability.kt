package io.snyk.plugin.cli

class Vulnerability {
    companion object {
        const val OVERVIEW_MARK = "## Overview"
    }

    lateinit var id: String
    lateinit var title: String
    lateinit var description: String
    lateinit var language: String
    lateinit var modificationTime: String
    lateinit var moduleName: String
    lateinit var packageManager: String
    lateinit var packageName: String
    lateinit var severity: String
    lateinit var name: String
    lateinit var version: String
    var exploit: String = ""
    var fixedIn: Array<String> = arrayOf()
    lateinit var from: Array<String>

    fun getPackageNameTitle(): String = "$packageName@$version: $title"

    fun getOverview(): String {
        val tempStr = description.substring(OVERVIEW_MARK.length, description.length)

        val endIndex = tempStr.indexOf("## ")

        return if (endIndex > 0) {
            tempStr.substring(0, endIndex)
        } else {
            ""
        }
    }
}
