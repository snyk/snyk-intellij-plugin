package io.snyk.plugin.ui.toolwindow.nodes.leaf

import com.intellij.openapi.project.Project
import io.snyk.plugin.ui.toolwindow.nodes.DescriptionHolderTreeNode
import io.snyk.plugin.ui.toolwindow.nodes.NavigatableToSourceTreeNode
import io.snyk.plugin.ui.toolwindow.panels.VulnerabilityDescriptionPanel
import snyk.oss.Vulnerability
import javax.swing.tree.DefaultMutableTreeNode

class VulnerabilityTreeNode(
    private val groupedVulns: Collection<Vulnerability>,
    val project: Project,
    override val navigateToSource: () -> Unit
) : DefaultMutableTreeNode(groupedVulns), NavigatableToSourceTreeNode, DescriptionHolderTreeNode {

    override fun getDescriptionPanel(): VulnerabilityDescriptionPanel {
        return VulnerabilityDescriptionPanel(groupedVulns)
    }
}
